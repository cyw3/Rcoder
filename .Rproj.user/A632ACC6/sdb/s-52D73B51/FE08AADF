{
    "contents" : "#收益率走势图\n\n#install.packages(\"devtools\")\n#library(devtools)\n#install_github('qutke/qutke')\n\nlibrary('lubridate')\nlibrary(qutke)\nkey<-\"faca4c8ff4dc1502d87944ea9cfd74f19918f0aef37fde6746b61d4d339bfcf3\"\ninit(key)\n\n#date <- Sys.Date()-1\n\n#某只股票收益率 = （当天的股价-买入价）/ 买入价 *100\n#需要参数：1、选定股票种类；2、买入的日期、买入价；3、买入之后到如今的日期，以及当天股价；4、收益率计算\n\n#收益率是按单个股票来说的\n\n#1、选定001979.SZ的招商蛇口，002142.SZ的宁波银行\n#http://xueqiu.com/p/ZH078564\nqtid <- c('002230.SZ','002715.SZ')\n#qtid <- '002230.SZ'\n\n#2、设定买入日期是2015-10-01，获取当天收盘价（假定买入价为收盘价）.均选为收盘价\ndate <- '2015-10-01'\n#股票日间行情(前复权)\ndailyQuote <- getDailyQuote(data='mktFwdDaily',qtid=qtid,startdate=date,enddate=Sys.Date(),key=key)\n#当日收盘价(前复权)\nstock1 <-dailyQuote[which(dailyQuote$qtid==qtid[1]),]\nstock2 <-dailyQuote[which(dailyQuote$qtid==qtid[2]),]\n\n#x轴，作为时间轴。取买入日期至今。\ntradingDay <- getDate(data='tradingDay',startdate=stock1$date[1],enddate=Sys.Date(),key=key)\n\n#归一化\n#dat1 <- as.character(tradingDay[1])\ni <- 1\nlength <- length(tradingDay)\nfwdAdjClose1 <- c()\nfwdAdjClose2 <- c()\nwhile(i<=length){\n  fwdAdjClose1 <- c(fwdAdjClose1,stock1[i,]$fwdAdjClose)\n  if(is.null(fwdAdjClose1[i])||is.na(fwdAdjClose1[i])) \n    fwdAdjClose1[i] <- fwdAdjClose1[i-1]\n  \n  fwdAdjClose2 <- c(fwdAdjClose2,stock2[i,]$fwdAdjClose)\n  if(is.null(fwdAdjClose2[i])||is.na(fwdAdjClose2[i])) \n    fwdAdjClose2[i] <- fwdAdjClose2[i-1]\n  \n  i=i+1\n}\nprint(fwdAdjClose1[length])\n\n#计算\nfwdAdjClose1 <- (fwdAdjClose1-fwdAdjClose1[1])/fwdAdjClose1[1]*100\nfwdAdjClose2 <- (fwdAdjClose2-fwdAdjClose2[1])/fwdAdjClose2[1]*100\n\n#形成dataframe\nyieldChart <- data.frame('date'=tradingDay,'2'=fwdAdjClose1,'3'=fwdAdjClose2)\npostData(yieldChart,name='yieldChart',key=key)\n\n\n\n#'001979.SZ'not find\n#industry <- getIndustry(data='industryType',date='2016-01-08',qtid=c('001979.SZ','002142.SZ'),key=key)\n\n#MD <- getMD(data='keyMap',qtid=qtid,key=key)\n\n#getDailyQuote(data='mktFwdDaily',qtid=c('001979.SZ','002142.SZ'),key=key)\n\n#getQtStock(data='financialIndex',qtid=qtid,key=key)\n\n#即第一列应为日期向量，其他列为数值向量\n#yieldChart <- data.frame('date'=c(as.Date('2016-1-1'),as.Date('2016-1-2'),as.Date('2016-1-3')),'2'=c(1,2,3),'3'=c(3,2,1))\n#names(yieldChart)<-c('代码','名称','日期')\n\n",
    "created" : 1453198056868.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "632626208",
    "id" : "FE08AADF",
    "lastKnownWriteTime" : 1453226992,
    "path" : "~/GitHub/Rcoder/qutke_code/20160118/yieldChart.R",
    "project_path" : "qutke_code/20160118/yieldChart.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}